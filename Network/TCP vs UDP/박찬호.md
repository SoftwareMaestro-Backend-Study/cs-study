## TCP (Transmission Control Protocol)

TCP(Transmission Control Protocol)는 네트워크에서 데이터를 전송하는 프로토콜이다. TCP/IP 프로토콜 스택의 핵심 프로토콜 중 하나로, 물리적인 네트워크 연결이 어떻게 되어있든지 간에 데이터를 신뢰성 있게 전달한다.

### TCP 주요 특징

- **신뢰성**:
    - TCP는 체크섬, 순차적인 패킷 전달, 재전송과 확인응답(ACK), 타임아웃 등의 방법을 사용해 신뢰성을 보장한다.
    - TCP는 패킷 손실을 감지하고 자동으로 재전송한다. 그 결과 데이터 전송의 신뢰성이 보장된다.
- **순서 보장**:
    - 각 TCP 세그먼트는 순서 번호를 가지며, 수신자는 이 순서 번호를 기반으로 세그먼트를 올바른 순서로 재조립한다. 순서에 맞지 않는 세그먼트는 버려진다.
    - TCP는 데이터를 받는 순서를 보장한다. 데이터는 송신된 순서대로 도착하며, 만약 순서가 꼬이면 TCP는 자동으로 재정렬한다.
- **흐름 제어**:
    - TCP는 수신자의 버퍼 크기와 처리 능력을 고려하여 데이터의 전송 속도를 제어한다. 이를 위해 수신 윈도우라는 개념을 사용한다.
    - TCP는 송신 측이 수신 측이 처리할 수 있는 속도보다 빠르게 데이터를 보내는 것을 방지한다.
- **혼잡 제어**:
    - TCP는 네트워크의 혼잡 상태를 감지하고 전송 속도를 조절하여 혼잡을 방지한다.
    - TCP는 네트워크의 혼잡 상태를 감지하고 전송 속도를 조절하여 혼잡을 방지한다.

### TCP Header Format

![image](https://github.com/SoftwareMaestro-Backend-Study/cs-study/assets/83508073/64ddabd0-7cd5-4f3f-9b4b-f7f61ab171d3)


TCP 메시지는 '세그먼트'라는 단위로 구성되며, 각 세그먼트는 헤더와 데이터 부분으로 구성된다. TCP 헤더의 주요 필드는 다음과 같다.

- **Source Port, Destination Port**: 이들은 각각 세그먼트의 출발지와 목적지를 식별한다.
- **Sequence Number**: 이 필드는 전송되는 데이터의 순서를 식별하고, 수신측에서 세그먼트를 올바른 순서로 재조립하는데 사용된다.
- **Acknowledgment Number**: 이 필드는 수신측이 다음에 받기를 원하는 데이터의 첫 번째 바이트를 가리킨다.
- **Code Bits(Flag)**: SYN, ACK, FIN, RST, PSH, URG 등의 다양한 제어 신호를 나타낸다.
- **Window**: 수신자가 현재 수신할 수 있는 데이터의 양을 나타낸다.
- **Checksum**: 세그먼트의 에러를 검출하는데 사용된다.

### TCP 3 way handshake

TCP는 장치들 사이에 논리적인 접속을 성립(establish)하기 위하여 three-way handshake를 사용한다.

> **Client > Server : TCP SYN**
> 
> 
> **Server > Client : TCP SYN ACK**
> 
> **Client > Server : TCP ACK**
> 

![image](https://github.com/SoftwareMaestro-Backend-Study/cs-study/assets/83508073/bbf0ba46-622c-4a95-b5d8-95f2fe8a7e18)

### TCP Congestion Control

TCP 혼잡 제어는 네트워크 내의 패킷 트래픽을 관리하는데 사용된다. 

혼잡 제어 알고리즘은 네트워크 내의 패킷 수를 제어하여 패킷 손실을 줄이고, 네트워크의 처리량을 최대화한다. 

1. **Slow Start**: TCP 연결이 초기화될 때, TCP는 네트워크의 혼잡 상황을 알지 못한다. 따라서, TCP는 소수의 세그먼트부터 시작해, 각각의 세그먼트에 대한 ACK를 받을 때마다 전송률을 증가시킨다. 즉, 처음에는 천천히 시작해서 혼잡이 없다는 것을 확인한 후에 점차 전송률을 높인다. 이때의 전송률 증가 속도는 지수적이다.
2. **Congestion Avoidance**: 느린 시작으로 전송률을 높여갈 때, 어느 순간 네트워크의 혼잡이 발생할 수 있다. 이때 패킷 손실이 발생하면, TCP는 전송률을 절반으로 줄이고, 그 다음부터는 선형적으로 전송률을 늘려나간다. 이를 통해 네트워크의 혼잡을 회피하려고 한다.
3. **Fast Retransmit**: TCP는 같은 ACK를 3번이나 받는 경우, 해당 패킷이 손실되었다고 판단한다. 이러한 상황이 발생하면, 재전송을 위해 기다리는 것이 아니라, 해당 패킷을 즉시 재전송한다.
4. **Fast Recovery**: 빠른 재전송 후에, TCP는 전송률을 절반으로 줄이고, 느린 시작이 아니라 혼잡 회피 알고리즘을 바로 시작한다. 이를 통해 혼잡 회피 단계로 더 빠르게 회복되도록 한다.

## UDP(User Datagram Protocol)

UDP(User Datagram Protocol) 역시 데이터를 네트워크로 전송하는 프로토콜이다. 그러나 TCP와는 달리 UDP는 연결을 설정하지 않고, 신뢰성을 보장하지 않으며, 순서도 보장하지 않는다.

### UDP 주요 특징

- **비연결성**
    - UDP는 송신자와 수신자 사이에 논리적인 연결을 설정하지 않는다. 즉, 패킷을 일관성 있게 보내지 않는다는 의미이다.
    - 이로 인해 UDP는 데이터를 빠르게 전송할 수 있지만, 패킷의 도착 순서가 보장되지 않는다.
- **무상태성**:
    - UDP는 패킷 간의 관계를 유지하지 않는다.
    - 각각의 패킷은 독립적으로 취급되며, 이전 패킷의 상태에 영향을 받지 않는다.
- **신뢰성 없음**:
    - UDP는 패킷 손실을 검출하거나 재전송을 시도하지 않는다.
    - 따라서 데이터 전송의 신뢰성이 떨어진다.
- **순서 보장 없음**:
    - UDP는 데이터의 순서를 보장하지 않는다.
    - 데이터는 송신 순서와 다를 수 있다.
- **오버헤드 감소**:
    - UDP는 헤더의 크기가 작기 때문에 데이터 전송에 필요한 오버헤드가 작다.
- **신뢰성보다 속도 중시**:
    - UDP는 패킷의 전달을 확인하는 메커니즘이 없어, 데이터의 유실 가능성이 TCP보다 높다.
    - 그러나 이러한 특성 덕분에 신속한 전송이 가능하며, 실시간 스트리밍이나 게임 등의 애플리케이션에서 주로 사용된다.

### UDP Header Format

![image](https://github.com/SoftwareMaestro-Backend-Study/cs-study/assets/83508073/236bfe69-17eb-455a-9f20-531809240f6e)

UDP 데이터그램은 매우 단순한 구조를 가지고 있다. 

- **Source port, destination port**: 이들은 데이터그램의 출발지와 목적지를 식별한다.
- **길이**: 이 필드는 헤더와 데이터를 포함한 전체 데이터그램의 길이를 나타낸다.
- **체크섬**: 이 필드는 패킷의 손상을 감지하기 위해 사용된다. 수신측에서 체크섬을 계산하고, 송신측에서 보낸 체크섬과 비교하여 패킷의 정확성을 확인한다.

UDP는 이런 간단한 구조로 인해 오버헤드가 적고, 빠른 전송 속도를 보장한다. 하지만 신뢰성이나 데이터 순서, 혼잡 제어 같은 기능은 제공하지 않으므로, 이러한 기능이 필요한 애플리케이션에서는 TCP를 사용해야 한다.

## TCP와 UDP 비교

TCP와 UDP는 둘 다 트랜스포트 계층의 프로토콜이지만, 여러 가지 중요한 차이점들을 가지고 있다.

1. **연결 설정**: 
    - TCP는 연결 지향적 프로토콜이다. 송신자와 수신자 간에 데이터 전송 전에 핸드쉐이크 과정을 거쳐 연결을 설정한다. 이를 통해 TCP는 신뢰성 있는 통신을 제공한다.
    - 반면, UDP는 비연결형 프로토콜로, 핸드쉐이크 과정 없이 데이터를 전송한다. 이로 인해 UDP는 빠른 데이터 전송을 가능하게 한다.
2. **신뢰성**: 
    - TCP는 신뢰성 있는 데이터 전송을 제공한다. ACK 메커니즘, 시퀀스 번호, 재전송 메커니즘 등을 통해 데이터의 순서, 무결성, 신뢰성을 보장한다.
    - 반면에 UDP는 이러한 기능을 제공하지 않아 데이터의 유실이나 순서 변경이 발생할 수 있다.
3. **전송 속도**: 
    - TCP는 신뢰성 있는 전송을 위해 데이터의 확인 및 재전송을 수행하므로, UDP에 비해 상대적으로 전송 속도가 느리다.
    - UDP는 신뢰성을 보장하지 않아도 되므로 데이터를 빠르게 전송할 수 있다.
4. **혼잡 제어**: 
    - TCP는 혼잡 제어 메커니즘을 가지고 있어 네트워크의 혼잡 상태를 관리한다.
    - UDP는 이러한 혼잡 제어 메커니즘을 제공하지 않는다.
5. **사용 사례**: 
    - TCP는 이메일, 웹 브라우징, 파일 전송 등 신뢰성이 중요한 애플리케이션에서 주로 사용된다.
    - 반면, UDP는 실시간 스트리밍, VoIP, 온라인 게임 등의 신속한 전송이 중요한 애플리케이션에서 주로 사용된다.
6. **헤더 크기**: 
    - TCP 헤더는 최소 20바이트이며, 옵션 필드가 추가될 수 있다.
    - 반면, UDP 헤더는 고정 크기로 8바이트만을 가진다.
  


re-pr
