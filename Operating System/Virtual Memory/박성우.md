### 가상 메모리

메모리 관리 비법

프로세스 전체가 메모리 내에 올라오지 않더라도 실행이 가능하도록 하는 기법

1. **사용자 프로그램이 물리 메모리의 제약에서 벗어남**
2. **각 프로그램이 더 작은 메모리를 차지하기 때문에 더 많은 프로그램을 동시 수행 가능**
3. **프로그램을 메모리에 올리고 swap 하는데 필요한 IO 횟수가 줄어듦**

### 컴퓨터 구조

CPU가 연산을 하려면 메모리에 존재하는 값을 참조해야한다.

CPU는 메인 메모리까지의 값까지만 참조할 수 있기 때문에, 보조 저장 장치의 값을 참조하려면 OS의 도움을 받아서 IO 작업을 진행한다.

CPU가 일을 하기 위해서는 프로그램의 정보가 메인 메모리에 올라와야한다.

프로그램이 실행되면 프로세스가 생성되고, 새로 생성된 프로세스의 주소공간을 사용하여 지정된 실행 파일을 메모리에 올라간다. 

즉, 프로그램이 실행되면 디스크에 존재하던 실행파일이 메모리에 올라오고 CPU가 해당 정보를 참조할 수 있다.

### 주소 바인딩

CPU가 바라보는 주소는 논리 주소이다.

CPU가 일을 하기 위해서는 논리주소가 메인 메모리상에 올라와있어야 한다.

논리주소가 물리적 메모리의 특정 위치로 매핑되는데, 이 작업을 주소 바인딩이라고 한다.

가상 메모리를 사용하기 위해서는 실행시간 바인딩을 해야한다.

이 기법을 사용해야 논리 주소와 물리 주소의 값이 달라진다.

### 스왑 영역

많은 프로세스가 메모리 상에 존재하면 메모리 공간이 부족해질 수 있다.

그래서 메모리 공간의 확장 영역으로 스왑 영역을 사용한다.

스왑 공간은 외부 저장장치에 존재하지만, 물리 메모리의 확장 개념이다.

스왑 영역은 프로세스가 수행 중인 동안에만 일시적으로 저장된다.

스왑 영역이 외부 저장 장치에 존재하기 때문에 OS에 의해 I/O 작업이 일어난다.

### 가상 메모리

물리 메모리의 공간이 부족해서 프로그램들을 실행시키지 못한다면,,?

프로그램에서 사용되지 않는 코드를 모두 물리 메모리에 올려놔야할까…?

필요한 내용만 물리 메모리에 올려놓고 사용하면 되지 않을까?

가상 메모리를 사용하면 프로세스 전체의 내용을 물리 메모리에 올릴 필요 없이 필요한 부분만 메모리에 올려 실행이 가능하다.

### 요구 페이징 기법

필요한 페이지만 물리 메모리에 적재하는 기법

주소 공간이 여러 페이지로 구성되어 있다.

필요한 페이지만 물리 메모리에 적재한다.

<img width="349" alt="1" src="https://github.com/SoftwareMaestro-Backend-Study/cs-study/assets/79205414/164ad8fc-e469-41db-9467-583045edb12f">



그렇다면 필요한 페이지가 물리 메모리에 존재하는지 어떻게 알까?

유 - 무효 비트

- Valid : 해당 페이지가 메모리에 있음
- Invalid : 해당 페이지가 메모리에 없음 ( 페이지 폴트 발생 )
    - 해당 프로세스는 중단
    - 보조 저장 장치에 페이지가 존재한다면 가져옴
    
![2](https://github.com/SoftwareMaestro-Backend-Study/cs-study/assets/79205414/6c969390-1a6e-4b24-bf87-f60327a81d75)



물리 메모리에 대응되는 페이지 테이블에 valid, invalid 비트로 물리적 메모리에서 페이지의 바인딩 정보를 확인할 수 있다.

---

### 1. 가상 메모리란 무엇인가요?

물리적인 메모리의 한계를 극복하기 위해 디스크 공간을 일시적으로 메모리처럼 사용하는 기술이다.


### 2. 가상 메모리는 어떻게 동작하나요?

프로세스가 요청한 메모리 공간을 물리적인 메모리(RAM)와 디스크 공간 사이에서 관리한다.

프로세스가 필요로 하는 메모리 공간은 Page 라는 고정 크기의 블록으로 나눠진다.

현재 사용하지 않는 페이지는 디스크에 스왑아웃된다. 

필요한 페이지가 사용되지 않은 경우, 스왑인된 페이지는 다시 물리적 메모리로 스왑인될 수 있다.

### 3. 가상 메모리와 실제 메모리의 차이점은 무엇인가요?

가상 메모리는 프로세스가 접근하는 메모리 공간을 디스크 공간에 확장하여 더 큰 메모리 공간을 제공한다.

가상 메모리는 디스크에 저장되어 있는 페이지를 필요할 때마다 실제 메모리에 스왑인하거나 스왑하는 방식으로 동작한다.

### 4. 가상 메모리의 장점은 무엇인가요?

프로세스의 메모리 공간이 물리적인 메모리 크기에 제한되지 않고 확장될 수 있다.

### 5. 가상 메모리의 단점은 무엇인가요?

가상 메모리를 사용하는 경우에도 일부 페이지는 디스크로 스왑아웃되기 때문에, 접근 시간이 물리적인 메모리에 비해 오래 걸릴 수 있다.

### 6. 스와핑과 페이지 폴트의 개념을 설명해주세요.

- 스와핑 : 스와핑은 가상 메모리에서 메모리 공간 부족으로 인해 현재 메모리에 올라와 있는 페이지를 디스크로 옮기는 것을 말한다. 스와핑은 메모리 관리를 위해 사용되며, 필요한 페이지를 메모리에 올리기 위해 스왑아웃할 페이지를 선택하여 디스크로 보내는 작업을 수행한다.

- 페이지 폴트 : 페이지 폴트는 프로세스가 실행되는 동안 필요한 페이지가 현재 메모리에 없는 경우 발생한다.

페이지 폴트가 발생하면 해당 페이지를 디스크에서 읽어와 메모리에 올리는 작업이 필요하다.

페이지 폴트는 가상 메모리 시스템에서 메모리 부재를 나타내며, 페이지 폴트가 빈번하게 발생할 경우 성능 저하가 발생할 수 있다.

1. CPU가 논리 메모리의 값을 참조하기 시작
2. invalid 비트의 페이지를 참조한다면 (물리적 메모리에 없다면) 페이지 폴트 발생
3. 페이지 폴트가 발생하면 CPU 제어권이 OS로 넘어가게 되고, 스왑 영역에서 해당 페이지를 참조해서 물리 메모리의 빈 공간에 올린다.

이렇게 필요한 페이지만 물리 메모리에 올려 사용하는 기법을 요구 페이징 기법이라고 한다.
